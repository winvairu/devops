## Part 1. Установка ОС

* Команда для вывода версии Ubuntu: 

	~$` cat /etc/issue.net`

	![cat /etc/issue.net](img/screenshot_2024_06_19_at_4_33_37_pm.png)

## Part 2. Создание пользователя

Создание пользователя, отличного от созданного при установке и добавление его в группу ` adm `:

1. Создааем нового пользователя с помощью команды `useradd`. В качестве примера создадим пользователя с именем `newuser`:

	~$` sudo useradd -m newuser `

	Параметр `-m` указывает на то, что домашняя директория пользователя должна быть создана автоматически.

2. Добавляем нового пользователя в группу `adm`:

	~$  `usermod -aG adm newuser`

	Параметр `-a` указывает на то, что пользователь должен быть добавлен в группу, даже если он уже входит в эту группу. Параметр `-G ` 	используется для добавления пользователя в одну или несколько групп.

3. Проверяем, был ли пользователь успешно добавлен в группу `adm`:

	~$`cat /etc/passwd`
	
	![cat /etc/passwd](img/screenshot_2024_06_19_at_5_31_30_pm.png)

## Part 3. Настройка сети ОС

1. Изменение название машины вида user-1:

	~$`hostnamectl set-hostname winvairu-1`
	
	![hostnamectl set-hostname winvairu-1](img/screenshot_2024_06_19_at_8_20_45_pm.png)

2. Установка временной зоны, по моему местоположению:

	~$`timedatectl set-timezone Europe/Moscow`

	![timedatectl set-timezone Europe/Moscow](img/screenshot_2024_06_20_at_10_13_33_am.png)

3. Консольная команда для вывода сетевых интерфейсов:

	~$`ip link`

	![ip link](img/screenshot_2024_06_20_at_11_05_32_am.png)

	* `lo` - это loopback интерфейс, который используется для обращения к самому себе внутри системы;

	* `enp0s3` - это Ethernet интерфейс, подключенный к сети.

4. Консольная команда для получения ip адреса моего рабочего устройства от DHCP сервера:

	* ~$`ip a`

		![ip a](img/screenshot_2024_06_20_at_11_36_33_am.png)
	
	* В данном примере IP-адрес 10.0.2.15 был получен устройством через DHCP для интерфейса enp0s3.

		DHCP - это сокращение от Dynamic Host Configuration Protocol, что в переводе с английского означает "протокол динамической конфигурации 		хостов". Это стандартный протокол, используемый в компьютерных сетях для автоматического назначения IP-адресов подключенным устройствам.

		Протокол DHCP работает следующим образом: когда устройство подключается к сети, оно отправляет запрос на специальный сервер DHCP, который 		назначает ему IP-адрес, маску подсети, адрес шлюза по умолчанию и другие необходимые параметры. После этого устройство может полноценно 		участвовать в работе сети.

		Преимущество использования DHCP заключается в том, что администраторам сетей не нужно вручную настраивать каждое устройство, чтобы оно 		могло 	работать в сети. Кроме того, DHCP позволяет легко управлять IP-адресами в сети, переназначая их при необходимости.

5. Определение и вывод на экран внешнего ip-адреса шлюза (ip) и внутреннего IP-адреса шлюза, он же ip-адрес по умолчанию (gw):

	* получения внешнего IP-адреса шлюза

		~$`curl ip.me`

		![curl ip.me](img/screenshot_2024_06_20_at_2_03_43_pm.png)
	
	*  получение внутреннего IP-адреса шлюза (IP-адрес по умолчанию)

		~$`ip route show default`
	
		![ip route show defaul](img/screenshot_2024_06_20_at_2_09_23_pm.png)
	
6. Cтатичные (заданные вручную, а не полученные от DHCP сервера) настройки ip, gw, dns (используются публичные DNS серверы, например 1.1.1.1 или 	8.8.8.8).

	Настроить все сетевые параметры можно 2-мя способами:
	
	* командами;

	* редактированием конфигурационных файлов.

	При использовании команд все настройки удаляются после перезагрузки системы. Поэтому, если нет необходимости держать выставленные настройки 	в течении долгого времени, то лучше воспользоваться командами.
	
	Рассмотрим вариант настройки сети в конфигурационном файле:
	
	* редактируем файл `etc/netplan/*.yaml`, после редактирования файл выглядит так:

		![etc/netplan/*.yaml](img/screenshot_2024_06_20_at_8_15_37_pm.png)
	
	*  Применяем изменения, выполнив команду:

		~$`sudo netplan apply`

	* Перезагружаем виртуальную машину.

	* Успешно пропингуем удаленные хосты 1.1.1.1 и ya.ru:

		~$`ping -c 4 1.1.1.1`
	
		~$`ping -c 4 ya.ru`
	
		`-c 4` указывает отправить 4 пакета (некоторые реализации позволяют указать количество пакетов до бесконечности, используя `-c -1`).
	
		`ya.ru` - это имя хоста, которое будет преобразовано в IP-адрес с помощью DNS.
	
		![ping -c 4 1.1.1.1 | ping -c 4 ya.ru](img/screenshot_2024_06_20_at_8_42_22_pm.png)

## Part 4. Обновление ОС

* Консольная команда для обновления системных пакетов:

	~$`sudo apt update &&  sudo apt full-upgrade -y`

	![sudo apt update &&  sudo apt full-upgrade -y](img/screenshot_2024_06_20_at_9_41_01_pm.png)

## Part 5. Использование команды sudo

1. Разрешаем пользователю `newuser` выполнять команду `sudo`:

	~$`usermod -aG sudo newuser`

	Команда `sudo` в `Linux` используется для предоставления пользователям возможности выполнять команды от имени другого пользователя, обычно с 	правами суперпользователя `root`. Это позволяет пользователям решать задачи, требующие административных привилегий, без необходимости 	работать 	напрямую под учетной записью `root`. Использование `sudo` помогает ограничить права пользователей и снизить риски безопасности, 	связанные с	работой с правами суперпользователя. Правила, определяющие, какие пользователи могут использовать `sudo` и какие команды они 	могут выполнять,	хранятся в файле `/etc/sudoers`.
	
2. Меняем `hostname` ОС от имени пользователя `newuser` (используя sudo);

	~$`hostnamectl set-hostname winvairu-2`
	
	![hostnamectl set-hostname winvairu-2](img/screenshot_2024_06_21_at_11_17_45_am.png)
	
## Part 6. Установка и настройка службы времени

1. Если нам нужно узнать текущее время в локальном часовом поясe:

	~$`date +%T`
	
	![date +%](img/screenshot_2024_06_21_at_1_43_32_pm.png)
	
2. ~$`timedatectl show`

	![timedatectl show](img/screenshot_2024_06_21_at_1_47_50_pm.png)
	
3. Переход с timesyncd на ntpd:

	* отключаем timesyncd ~$`sudo timedatectl set-ntp no`

	* устанавливаем ntp ~$`sudo apt install ntp`
	
	Демон `ntpd` запускается автоматически после установки. Запрашиваем состояние `ntpd`:
	
	~$`ntpq -p`
	
	![ntpq -p](img/screenshot_2024_06_21_at_2_42_54_pm.png)
	
	`ntpq` – это инструмент запросов для ntpd. Флаг `–p` запрашивает данные о серверах NTP, к которым подключается ntpd. Ваш вывод будет 	отличаться, но в нём всё равно должен быть стандартный пул Ubuntu и несколько других серверов.
	
	На установку соединения ntpd потребуется несколько минут.
	
## Part 7. Установка и использование текстовых редакторов

1. VIM:

	![:wq](img/screenshot_2024_06_21_at_3_25_15_pm.png)
	
	* Команда для выхода с сохранением изменений: `:wq`

	* Команда для выхода без изменений: `:q!`

		![:q!](img/screenshot_2024_06_21_at_6_36_10_pm.png)
	
	* Поиска слова и его замена на другое в редакторе Vim:

		`:s/\<cranbero\>/winvairu/`
	
		![:q!](img/screenshot_2024_06_21_at_8_33_43_pm.png)

2. nano:

	![nano](img/screenshot_2024_06_21_at_3_53_59_pm.png)
	
	* Команда для выхода с сохранением изменений: `^S`, `^X`

	* Команда для выхода без изменений: `^X`, `N`

		![X N](img/screenshot_2024_06_21_at_6_48_06_pm.png)
	
	* Для поиска и замены текста используется команда `Option+R`.

		![Option+R1](img/screenshot_2024_06_21_at_8_54_42_pm.png)
	
		![Option+R2](img/screenshot_2024_06_21_at_8_55_05_pm.png)
	
		![Option+R3](img/screenshot_2024_06_21_at_8_55_40_pm.png)
	
3. joe:

	![joe](img/screenshot_2024_06_21_at_3_52_12_pm.png)

	* Команда для выхода с сохранением изменений: `^KX`

	* Команда для выхода без изменений: `^KQ`

		![KQ](img/screenshot_2024_06_21_at_7_21_06_pm.png)
	
	* Для выполнения поиска и замены файл должен содержать более одного слова, поэтому добавляем:

		![hi](img/screenshot_2024_06_22_at_10_42_18_am.png)
	
	* Вводим `^K F`. Нам будет предложено ввести строку, которую мы хотим найти, в данном случае `cranbero`:

		![kf](img/screenshot_2024_06_22_at_11_17_32_am.png)
	
	* Затем нам будет предложено указать параметры типа поиска, но в этом простом случае просто нажимаем клавишу `R`;

	* Далее вводим слово для замены и подтверждаем клавишей `Y`:

		![y](img/screenshot_2024_06_22_at_11_18_25_am.png)
	
## Part 8. Установка и базовая настройка сервиса SSHD

1. Установка службы SSHd:

	~$`sudo apt install openssh-server`
	
2. Добавляем автостарт службы при загрузке системы:

	~$`sudo systemctl enable ssh`
	
3. Перенастройка службы SSHd на порт 2022. Все настройки сервера SSH хранятся в конфигурационном файле `sshd_config`, который находится в папке 	`/etc/ssh`. Перед тем как вносить изменения в этот конфигурационный файл рекомендуется сделать его резервную копию, для этого используем таую 	команду:

	~$`sudo cp /etc/ssh/sshd_config /etc/ssh/sshd_config.factory-defaults`
	
	Переходим к настройке конфигурационного файла:
	
	~$`sudo vim /etc/ssh/sshd_config`
	
	![sshd_config](img/screenshot_2024_06_22_at_12_47_52_pm.png)
	
	Перезапускаем службу SSH:
	
	~$`sudo systemctl restart ssh`
	
4.  Находим наличие процесса sshd:

	~$`ps -ax | grep sshd`
	
	Флаг `-a` обозначает все процессы, а `-x` — выводит все процессы, даже те, которые не связаны с текущим TTY.
	
	![ps -ax | grep sshd](img/screenshot_2024_06_22_at_1_24_26_pm.png)
	
5. ~$`netstat -tan`:
	
	![netstat -tan](img/screenshot_2024_06_22_at_1_26_43_pm.png)
	
	Команда `netstat -tan` в консоли Ubuntu показывает список всех активных сетевых соединений на вашем компьютере. Каждая строка вывода содержит 	следующую информацию:

	* `Proto` - Протокол, используемый для данного соединения. Обычно это TCP или UDP.

	* `Recv-Q` - Количество байт данных, которые были получены от удаленного хоста, но еще не были прочитаны процессом, использующим соединение.

	* `Send-Q` - Количество байт данных, которые были отправлены местным процессом, но еще не были доставлены удаленному хосту.

	* `Local Address` - Локальный адрес и порт, используемые для данного соединения.

	* `Foreign Address` - Удаленный адрес и порт, используемые для данного соединения.

	* `State` - Состояние соединения. Возможные состояния включают ESTABLISHED (соединение установлено), LISTEN (процесс ожидает входящих 	соединений), CLOSE_WAIT (удаленный хост закрыл соединение, но локальный процесс еще не завершил его), TIME_WAIT (соединение было закрыто, но 	оно остается открытым некоторое время для обработки возможных повторных передач пакетов) и другие.

	`netstat` — это утилита командной строки в Unix-подобных операционных системах, которая отображает информацию о сетевых соединениях, включая 	открытые порты и статистику по ним.

	Ключи имеют следующие значения:

	`-t`: Показывает все TCP-соединения.
	
	`-a`: Показывает все соединения (активные и неактивные).
	
	`-n`: Отключает разрешение имен для хостов и портов, то есть вместо имён используются числовые IP-адреса и номера портов. Это может быть 	полезно, если DNS не работает или нужно избежать лишних запросов к DNS-серверу.

	Значение `0.0.0.0` в столбцах `Local Address` и `Foreign Address` при выполнении команды `netstat -tan` указывает на то, что IP-адрес не 	определен 	или не назначен. Это обычно происходит, когда приложение или служба слушает все IP-адреса на сетевом интерфейсе, не 	конкретизируя какой-либо 	определенный IP-адрес.

	Однако стоит отметить, что `0.0.0.0` также может указывать на проблемы с конфигурацией сети или приложения, поэтому если вы видите это 	значение 	и не уверены, что оно должно быть там, рекомендуется обратиться к документации соответствующего приложения или службы для 	уточнения.
	
## Part 9. Установка и использование утилит top, htop

1. Утилита top.

	![top](img/screenshot_2024_06_22_at_3_14_38_pm.png)
	
	![top2](img/screenshot_2024_06_22_at_3_14_49_pm.png)
	
	* uptime: `9:28`
	
	* количество авторизованных пользователей: `1`
	
	* общую загрузку системы: `0`
	
	* общее количество процессов: `104`
	
	* загрузку cpu: `0`
	
	* загрузку памяти `162.5`
	
	* pid процесса занимающего больше всего памяти: `699`
	
	* pid процесса, занимающего больше всего процессорного времени: `2807`	
2. Утилита htop.

	* Сортировка по PID:
	
	![PID](img/screenshot_2024_06_22_at_3_54_32_pm.png)
	
	* Сортировка по PERCENT_CPU:
	
	![PERCENT_CPU](img/screenshot_2024_06_22_at_3_54_59_pm.png)
	
	* Сортировка по PERCENT_MEM:
	
	![PERCENT_MEM](img/screenshot_2024_06_22_at_3_55_47_pm.png)
	
	* Сортировка по TIME:
	
	![Сортировка по TIME](img/screenshot_2024_06_22_at_3_56_08_pm.png)
	
	* Фильтрация для процесса sshd:

	![sshd](img/screenshot_2024_06_22_at_4_00_51_pm.png)
	
	* Процесс syslog, найденный, используя поиск:

	![syslog](img/screenshot_2024_06_22_at_4_03_43_pm.png)
	
	* Добавленный вывод hostname, clock и uptime:

	![hostname_clock_uptime](img/screenshot_2024_06_22_at_4_18_52_pm.png)
	
## Part 10. Использование утилиты fdisk

~$`fdisk -l`

![fdisk -l](img/screenshot_2024_06_23_at_10_06_42_am.png)

![fdisk -l2](img/screenshot_2024_06_23_at_10_09_29_am.png)

* Название жесткого диска: `dev/sda`;

* Размер и количество секторов: `26843545600 bytes`, `52428800 sectores`;

* размер `swap`: не указан.

## Part 11. Использование утилиты df

1. Команда: ~$`df`:

	![df](img/screenshot_2024_06_23_at_11_07_29_am.png)

	* Информация корневого раздела (/):

		- размер раздела: 11758760;
	
		- размер занятого пространства: 5032100;
	
		- размер свободного пространства: 6107552;
	
		- процент использования: 46%.

	* единица измерения в выводе: 1K-blocks.

2. Команда: ~$`df -Th`:

	![df -Th](img/screenshot_2024_06_23_at_11_15_48_am.png)
	
	* Информация корневого раздела (/):

		- размер раздела: 12G;
	
		- размер занятого пространства: 4.8G;
	
		- размер свободного пространства: 5.9G;
	
		- процент использования: 46%.

	* Tип файловой системы для раздела: `ext4`.

## Part 12. Использование утилиты du

1. Запускаем команду ~$`du`:

	![du](img/screenshot_2024_06_23_at_12_14_03_pm.png)

2. Выводим размер папок /home, /var, /var/log (в байтах, в человекочитаемом виде):

	![/home](img/screenshot_2024_06_23_at_1_06_19_pm.png)
	
	![/var](img/screenshot_2024_06_23_at_1_07_56_pm.png)
	
	![/var/log](img/screenshot_2024_06_23_at_1_09_35_pm.png)

3. Выведи размер всего содержимого в /var/log (не общее, а каждого вложенного элемента, используя *)

	![/var/log21](img/screenshot_2024_06_23_at_1_14_21_pm.png)
	
	![/var/log22](img/screenshot_2024_06_23_at_1_14_50_pm.png)
	
	![/var/log23](img/screenshot_2024_06_23_at_1_15_05_pm.png)
	
## Part 13. Установка и использование утилиты ncdu

1. Hазмер папки /home:

	![ncdu/home](img/screenshot_2024_06_23_at_3_47_02_pm.png)

2. Hазмер папки /var:

	![ncdu/var](img/screenshot_2024_06_23_at_3_47_20_pm.png)

3. Hазмер папки /var/log:

	![ncdu/var/log](img/screenshot_2024_06_23_at_3_47_20_pm.png)
	
## Part 14. Работа с системными журналами

Смотрим логи:

1. /var/log/dmesg

	~$`less /var/log/dmesg`
	
	![less /var/log/dmesg](img/screenshot_2024_06_23_at_4_12_57_pm.png)

2. /var/log/syslog

	~$`less /var/log/syslog`
	
	![less /var/log/syslog](img/screenshot_2024_06_23_at_4_15_57_pm.png)

3. /var/log/auth.log

	~$`less /var/log/auth.log`
	
	![less /var/log/auth.log](img/screenshot_2024_06_23_at_4_19_56_pm.png)

	* Время последней успешной авторизации: `Jun 21 11:17:12`, имя пользователя: `newuser` и метод входа в систему: `local`

		![grep -i "successful" /var/log/auth.log](img/screenshot_2024_06_23_at_4_56_52_pm.png)

	* Перезапускаем службу sshd:

		~$`sudo systemctl restart sshd`

	* Скрин с сообщением о рестарте службы:

		![sudo systemctl restart sshd](img/screenshot_2024_06_23_at_6_54_07_pm.png)
		
## Part 15. Использование планировщика заданий CRON
	
1. Создаем новый файл в директории /etc/cron.d/ с именем uptime_checker.

2. Добавляем следующую строку в файл: `    */2  *   *   *   *  root uptime >> /var/log/uptime.log 2>&1`

	Эта строка означает следующее:
	
   	-  `*/2`: запускать каждые 2 минуты.
   	
   -  `*   *   *   *   *`: указывает на то, что задача должна выполняться каждый час, каждый день, каждый месяц, каждый день недели.
   
   - `root`: указывает, что задача должна выполняться от имени пользователя root.
   
   - `uptime`: команда, которую нужно выполнить.
   
   - `>> /var/log/uptime.log`: записывать вывод команды в файл `/var/log/uptime.log`.

3. Запускаем команду `sudo crontab /etc/cron.d/uptime_checker` для применения изменений.

	![crontab](img/screenshot_2024_06_23_at_7_54_43_pm.png)
	
4. Удаляем все задания из планировщика заданий. Скрин со списком текущих заданий для CRON.

	![crontab -r](img/screenshot_2024_06_23_at_8_08_42_pm.png)